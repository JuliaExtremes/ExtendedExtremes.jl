<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Application: Precipitation · ExtendedExtremes.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ExtendedExtremes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ExtendedExtremes.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">ExtendedExtremes Package</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../">Getting started</a></li><li><a class="tocitem" href="../distributions/">Extended GP distributions</a></li><li class="is-active"><a class="tocitem" href>Application: Precipitation</a><ul class="internal"><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Modeling-the-non-zero-precipitation"><span>Modeling the non-zero precipitation</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../functions/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Application: Precipitation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Application: Precipitation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaExtremes/ExtendedExtremes.jl/blob/master/docs/src/tutorial/precipitation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Application-to-summer-precipitation-recorded-in-Montréal,-QC"><a class="docs-heading-anchor" href="#Application-to-summer-precipitation-recorded-in-Montréal,-QC">Application to summer precipitation recorded in Montréal, QC</a><a id="Application-to-summer-precipitation-recorded-in-Montréal,-QC-1"></a><a class="docs-heading-anchor-permalink" href="#Application-to-summer-precipitation-recorded-in-Montréal,-QC" title="Permalink"></a></h1><p>In this section, we show that the EGP model based on the truncated Beta distribution can be used to model non-zero precipitation, which corresponds to exceedances above the very low threshold of 0, while maintaining the tail behavior.</p><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>The daily summer precipitation (May–October) recorded at the Montréal-Trudeau International Airport meteorological station (Québec, Canada) from 2000 to 2020 are investigated. This dataset can be loaded using the <a href="tutorial/@ref"><code>ExtendedExtremes.dataset</code></a> provided for this tutorial.</p><pre><code class="language- hljs">data = ExtendedExtremes.dataset(&quot;pcp&quot;)
filter!(row -&gt; row.Date&gt;= Date(2000,1,1), data)
filter!(row -&gt; month(row.Date) in 5:10, data)
dropmissing!(data)
first(data,5)</code></pre><h2 id="Modeling-the-non-zero-precipitation"><a class="docs-heading-anchor" href="#Modeling-the-non-zero-precipitation">Modeling the non-zero precipitation</a><a id="Modeling-the-non-zero-precipitation-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-the-non-zero-precipitation" title="Permalink"></a></h2><p>The EGP parameter estimation with maximum likelihood is performed with the <a href="tutorial/@ref"><code>fit_mle</code></a> function.</p><pre><code class="language- hljs">u = 0.0
y = data.pcp[data.pcp .&gt; u] .- u;

fd = fit_mle(ExtendedGeneralizedPareto{TBeta}, y)</code></pre><p>Several diagnostic plots for assessing the accuracy of the EGP model fitted to the Montréal data are can be shown with the <a href="tutorial/@ref"><code>diagnosticplots</code></a> function:</p><pre><code class="language- hljs">set_default_plot_size(16cm, 16cm)
ExtendedExtremes.diagnosticplots(y, fd)</code></pre><p>The diagnostic plots consist in the probability plot (upper left panel), the quantile plot (upper right panel), the density plot (lower left panel) and the return level plot (lower right panel). These plots can be displayed separately using respectively the <a href="tutorial/@ref"><code>probplot</code></a>, <a href="tutorial/@ref"><code>qqplot</code></a>, <a href="tutorial/@ref"><code>histplot</code></a> and <a href="tutorial/@ref"><code>returnlevelplot</code></a> functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../distributions/">« Extended GP distributions</a><a class="docs-footer-nextpage" href="../../contributing/">Contributing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 31 March 2023 13:29">Friday 31 March 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
